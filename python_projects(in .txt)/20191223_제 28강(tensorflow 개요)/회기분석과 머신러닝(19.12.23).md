### <u>(19/12/24) 회귀분석과 머신러닝</u>

#### 복습(들어가기 전에)

- R이란 무엇인가 
- 데이터 타입, 자료구조, 함수, 라이브러리 
- EDA(Exploratory Data Analysis, 탐색적 데이터 분석) 

>데이터가 어떠한 형태로 되어 있는지 확인하고 어떠한 feature(변수, 컬럼) 존재하는지 
>
>탐색하는 과정 (데이터 자체만을 분석하는 과정, 새로운 관점 X
>
>→ 전처리 과정(Data Pre processing)을 수행할 수 있다! (결측치, 이상치 등등)
>
>Feature Engineering (특징 -> 칼럼, 필요한 칼럼만 뽑아내고 방향성을 구체화)

- CDA(Confirmatory Data Analysis, 확증적 데이터 분석)

> ex/ 마케팅에서 주장하고 싶은 이론이 있음 →이를 뒷받침 하기 위한 근거를 마련하는 분석과정 
>
> 데이터를 통해서 새로운 관점을 제시함. (EDA가 선행되어야 함) 

※ Ex/ 

EDA: 제품에 대한 소비자 트렌드(경향)을 이해하기 위해서 사용하는 기법 

CDA: 마케팅 제안서에서 자신이 주장하는 근거를 뒷받침하기 위해

​		  데이터를 조사한 후 결과를 설명하는 기법

---

#### 0. 통계적 기법을 이용한 데이터 분석 

> 통계적 기법을 이용한 데이터 분석은 크게 2가지로 분류 

- 기술통계(Descriptive Statistics)

> * 어떤 사상(事象)에 대하여 관찰하거나 측정한 결과의 특성을 전체적으로 파악할 수 있도록 요약 · 기술해 주는 통계적 방법
>
> * 2가지 기법을 이용해서 데이터를 처리
>   * 집중화 경향에 대한 분석(평균, 중앙값, 최빈값...)
>   * 분산도에 따른 경향 분석(표준편차, 사분위) : 데이터가 어디에 몰려있고 어디에 퍼져있는가  
>
> → 수집한 데이터를 <u>요약, 묘사, 설명</u>하는 통계 기법을 의미
>
> 예) 우리나라 1인당 국민소득을 이요한 소득 불균형 확인 
>
>  

- 추리(추론) 통계(Inferential Statistics)

> * 얻어진 하나의 표집(標集)을 통하여 전집(全集)의 모수치(母數値)를 추정하는 통계적 방법. 이를 표집통계, 또는 귀납적 통계 방법이라고도 지칭
>
> * 표본에서 얻은 사실을 근거로 모집단에 대한 가설이 맞는지를 통계적으로 검증하는 분석방법 
>
>   → 통계적 가설 검정(Statistical Hypothesis Testing)
>
> → 수집한 데이터를 기반으로 어떠한 사실을 <u>예측(추론)하고 검정</u>하는데 사용하는 통계 기법을 의미 
>
> →머신러닝, 딥러닝과 맞닿아 있는 부분이 많은 통계



※ 여기까지 과정(미래예측)을 이해하기 위한 Base.

※ 여러가지 통계적 가설 검정 기법 중 regression(회귀 분석)을 마저 살펴보자 



#### 1. 회귀분석(Regression Anaylsis)

- 통계학에서 중요한 역할을 담당하는 자료분석 방법 (이하 Regression으로 통칭)

- 어떤 데이터, 어떤 갈래의 조사에 적용하면 좋을까?

> 출발점 : 우리가 얻은(관찰한) 데이터가 어떤 특정한 경향성을 가지고 있지 않을까?(여기서 기인)

- 관찰된 자료의 변수들(온도, 판매량) 사이에서 나타나는 경향성 혹은 의존성을 수학적으로 판별하고자 하는 기법 → 연관성 자체를 수학적으로(수식으로) 모델링하자 
- 모델을 찾아냄으로서 향후 유사한 문제에도 미래를 예측할 수 있다. (재현성)
- 이러한 경향성 혹은 의존성을 발견할 수 있다면 앞으로 발생한 일에 대해서 prediction이 가능하다 

- 회귀분석의 종류 

> 독립변수가 1개일 때 :  단순 회기분석
>
> 독립변수가 2개 이상일 때 :  다중 회기분석

- 이런 회기분석을 먼저 하는 이유는 이 회귀분석이 maching learning의 지도학습에 연관되기 때문! 



#### 2. Machine Learning 

> * Machine Learning은 소프트웨어 → 즉 프로그램. 
>
> * Machine Learning의 대두 배경 → Explicit program의 한계때문에 대두. 
>
> ※Explicit program 이란? : 사실상 모든 프로그램, 입력 데이터의 형태가 정해져 있고 출력데이터가 정해져 있음. 무수한 경우의 수가 아닌 특정한 알고리즘으로 행동양식들이 정해져 있다. 
>
> * (특정 목적을 위한)경우의 수가 너무 많은 프로그램들의 경우 순수하게 코딩으로 구현하기 어렵다. 
>
>   예) 알파고(바둑에서 나오는 경우의 수를 코딩하기란 사실상 불가능)
>
>   ​      메일 필터링, 자율 주행 자동차 등 
>
>   ​      현재 요구되는 케이스 중에서 경우의 수가 없는 것을 찾기가 더 어려움. 
>
> *  1959년 Arthur Samuel 이라는 사람이 Machine Learning 프로그램 자체가 데이터를 기반으로 학습을 통해서 배우는 능력을 가지는 프로그래밍 제시(데이터에 따라 프로그램이 계속 변함) 



​	**2.1 Machine learning 학습의 종류**

http://solarisailab.com/archives/1785

1) 지도 학습(Supervised Learning )

> * training data set이 존재 → label화 된 학습데이터 (향후 커리큘럼의 주된 기법 )
> * (데이터, 레이블)의 형태 
> * 명시적인 정답이 주어진 상태에서 컴퓨터를 학습시키는 방법 
>
> ex/ 오리그램1 (학습데이터) - 오리(학습데이터의 label )  → 입력 
>
> ​	  오리그램2(조금 다르게 생긴 학습데이터) - 오리(동일한 label) → 입력 
>
> ​          ...... 
>
> ​	  토끼그림1 - 토끼 → 입력
>
> ​	  고슴도치1 - 고슴도치  → 입력 
>
> 학습진행 (모델 생성 )
>
> ------
>
> 오리그림 3 --------> 모델 ->>>>>>>>>>>> 오리에요!! 
>
> * 당연하게도 지도학습에 적용되는 통계 기법은 regression 
>
> * 지도학습은 다시 3가지 유형으로 나눌 수 있다. 
>
>   * (1) linear regression(선형회귀)
>
>   > https://m.blog.naver.com/lyshyn/221285033204
>
>   > : <u>종속 변수 y</u>(dependent variable)와 <u>한 개 이상의 독립 변수 X</u>(independent variable)와의 <u>선형 상관 관계</u>를 모델링하는 회귀분석 기법
>   >
>   > * 주어진 데이터를 대표하는 하나의 직선을 찾는 것 (선형이 아닌 자료면 찾을 수 없다)
>   > * Machine Learning 중에 지도학습 방법 중 가장 기본이 되는 학습방식 
>   > * 후술할 회귀분석 기법들의 시작점 
>   >
>   > x(시간) → y(성적) 
>   >
>   > ​     1       →       5
>   >
>   > ​     2       →       15
>   >
>   > ​     5       →       68
>   >
>   > ​     8       →       80
>   >
>   > ​     10     →       95
>   >
>   > * 우리의 예제도 이런 linear한 형태로 가정한다! 
>   >
>   >   * 하나의 가설(Hypothesis)을 만들수 있어요! (1차 함수그래프, H(x) = wx +b )
>   >
>   >     (Weight 의 W(기울기), bias 의 b(절편))
>   >
>   >   * 이 가설을 수정(W와 b를 계속적으로 변화시켜나감) 해 나가면서 데이터의 상태를 가장 잘 표현하는 형태의 가설을 완성해 나가는 과정 → **학습 (learning)**이라고 지칭
>   >
>   >   * 학습
>   >
>   >   > H(x) = wx +b 
>   >
>   >   > 실제 데이터에 근접한 가설을 찾기 위해 최적의 H(x)를구하기 위해 점(실제데이터)과 선(가설) 사이의 <u>거리가 최소가 되는 w와 b를 찾아야 한다</u>. 이때 ...
>   >
>   >   * 이 가설을 수저해 나갈 때 **최소제곱법(least squares approximation)**이라는 방식을 이용한다. 
>   >
>   >   * 최소 제곱법
>   >
>   >     >  가설과 데이터의 간격의 제곱의 평균을 구해서 이 값이 작은 가설이 더 좋은 가설이 되는 방식 
>   >     >
>   >     > {(H(x1) - y1)^2 +(H(x2) - y2)^2 + (H(x3) - y3)^2  ~ ~ (H(xn) - yn)^2} / n 
>   >     >
>   >     > 
>   >
>   >   
>   >
>   >   * 비용함수(cost function, loss function) : Cost(W,b)
>   >
>   >     >  더 좋은 가설을 도출하기 위한 비용을 도출하기 위한 함수
>   >     >
>   >     > H(X) = wx+b 에서 w와 b를 구하기 위한 함수 
>   >     >
>   >     > → x축이 w, y축이 cost(w) 인 함수가 됨(y값은 항상 양수 )
>   >     >
>   >     > → 미분을 통해 w가 0이 되는 지점을 반복해서 찾는 것이 학습하는 과정 
>   >
>   >   ![cost function에 대한 이미지 검색결과](../../TIL/TIL/image/9968F8495B17954629.png)
>   >
>   >   * 선형구조에서 비용함수란 곧 최소 제곱법 (일차 함수) 
>   >
>   >     
>   >
>   >   
>
>   * (2) logistic regression(binary classification)
>
>   > : 
>   >
>   > * 영국의 통계학자인 D. R. Cox가 1958년 에 제안한 확률 모델로서 <u>독립 변수의 선형 결합을 이용</u>하여 <u>사건의 발생 가능성을 예측</u>하는데 사용되는 통계 기법
>   > * 알고리즘 중 가장 보편화되고 정확한 알고리즘 
>   >
>   > * 로지스틱 곡선이라는 특이한 형태의 곡선을 형성하게됨(0과 1사이로 종속변수 제한)
>   > * 
>   >
>   > x(시간) → y(성적) 
>   >
>   > ​     1       →       Fail
>   >
>   > ​     2       →       Fail
>   >
>   > ​     5       →       Fail
> >
>   > ​     8       →       Pass
> >
>   > ​     10     →       Pass
>   
>   * (3) Multinomial classification (=다중 로지스틱 회귀분석)
>   
>     > : <u>y의 범주가 3개 이상</u>(multi)이며 명목형(nomial)일 때 사용하는 로지스틱 회귀분석
>     >
>     > x(시간) → y(성적) 
>     >
>     > ​     1       →       F
>     >
>     > ​     2       →       F
>     >
>     > ​     5       →       C
>     >
>     > ​     8       →       B
>     >
>     > ​     10     →       A

2) 비지도 학습(Unsupervised Learning)

> - 데이터에 대한 레이블(Label)-명시적인 정답-이 주어지지 상태에서 컴퓨터를 학습시키는 방법론이다.
>
> - (데이터) 형태로 학습을 진행 
>
> - '클러스터링(Clustering)' 이라고도 지칭 
>
>   : 데이터가 무작위로 분포되어 있을때, 이 데이터를 비슷한 특성을 가진 세가지 부류로 묶는 클러스터링(Clustering) 알고리즘이 있다.**

> ex/ training data set이 존재 → label이 없다. 
>
> 오리그림 1											 오리그림 1, 오리그림2
>
> 오리그림 2				→	  → 	→      토끼그림1
>
> 토끼그림 1				(학습이 진행)	  고슴도치1  		
>
> 고슴도치 1

3) 강화학습(Reinforcement Learning)

> * 앞서 살펴본 알고리즘들이 데이터(data)가 주어진 정적인 상태(static environment)에서 학습을 진행하였다면, **강화 학습(Reinforcement Learning)은 에이전트가 주어진 환경(state)에 대해 어떤 행동(action)을 취하고 이로부터 어떤 보상(reward)을 얻으면서 학습**을 진행한다.
>
> * 에이전트는 보상(reward)을 최대화(maximize)하도록 학습이 진행된다. 즉, 강화학습은 일종의 동적인 상태(dynamic environment)에서 데이터를 수집하는 과정까지 포함되어 있는 알고리즘이다.

(일단은 여기까지)

----

**2.2 Machine Learning의 일반적인 응용** 

> * 현업에서의 응용사례들 
>
> ex/ 이미지검색, 도난 신용카드 판별(사용 boundary, 구매패턴 등 학습), 예상 매출액 산출, 시험 성적 예측 
>
> * 텐서플로우(Tensorflow) 를 통한 학습과정의 코드 구현 (우리는 python용 tensorflow를 쓸 것)
>
>   ``` 
>   activate cpu_env
>   pip install tensorflow 
>   ```
>
>   

