### 합성곱 신경망(CNN)

> CNN은 이미지 인식과 음성 인식 등 다양한 곳에서 사용되며, 
>
> 특히 이미지 인식 분야에서 딥러닝을 활용한 기법은 거의 CNN을 기초로 한다.
>
> → CNN의 매커니즘을 자세히 설명하고 이를 파이썬으로 구현해보자 



#### 1. 전체 구조 

> * Affine계층
>
> 지금까지 배운 신경망은 인접하는 계층의 모든 뉴런과 결합되어 있다. 
>
> → 이를 '완전연결(Fully-Connected, 전결합)' 이라 지칭한다. 
>
> → 완전히 연결된 계층을 'Affine 계층' 이라는 이름으로 구현한다. 
>
> 완전연결 신경망은 Affine 계층 뒤에 활성화 함수를 갖는 ReLU(또는 Sigmoid)계층이 이어진다.
>
> → 마지막 계층은 Affine계층에 이어 Softmax계층이 이어지며 최종결과(확률)를 출력한다. 
>
> * 합성곱 계층 & 풀링 계층
>
> CNN에서는 새로운 계층이 '합성곱(convolution)' 계층과 '풀링(Pooling)' 계층이 추가된다. 
>
> → CNN 계층은 'Conv-ReLU-(Pooling)' 의 흐름으로 연결된다.(Pooling은 불필요시 생략)
>
> → 'Affine-Relu' 에서 'Conv-ReLU-(Pooling)' 로 변화 
>
> 또한, 출력이 가까운 층에서는 지금까지의 Affine-Relu 구성을 사용할 수 있다.
>
> 마지막 출력 계층에서는 Affine-Softmax 조합을 그대로 사용한다. 
>
> ![완전연결 계층과 합성곱 계층](.\완전연결 계층과 합성곱 계층.png)

#### 2. 합성곱 계층 

> - 완전 연결 계층의 문제점 
>
> > * 완전 연결 계층은  '데이터의 형상이 무너진다' 는 단점이 있음. 
> >
> > : 대표적으로 이미지 데이터 → 세로, 가로, 채널(색상) 로 구성된 '3차원 데이터'
> >
> > * 그러나 기존 사례에서는 1차원으로 펴낸 데이터로 입력  
> >
> > (ex/ mnist → (1,28,28) 1채널, 세로 28픽셀, 가로 28픽셀을 1줄로 세운 784개 데이터化) 
> >
> > * 기존 이미지데이터는 3차원 형상으로서 갖는 고유한 정보들이 담겨있음
> >
> > (ex/ 공간적으로 같은 픽셀은 값이 비슷하다, 거리가 먼 픽셀끼리는 별 연관이 없다, 
> >
> > ​        RGB의 각 채널은 서로 밀접한 연관성이 있을 수 있다 etc....)
> >
> > * 완전연결 계층은 이러한 3차원 속에서 의미를 갖는 본질적인 패턴을 놓치고 모든 입력 데이터를 동등한 뉴런으로 취급하여 형상이 담긴 정보를 살릴 수 없음! 



